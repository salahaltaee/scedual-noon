<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ù†ØµØ© Ù†ÙˆÙ†</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: "Tahoma", sans-serif; background: #f8f9fa; margin: 20px; }
    h1, h2 { text-align: center; color: #333; }
    .section { background: #fff; padding: 20px; margin: 15px auto; border-radius: 8px; box-shadow: 0 0 5px #ddd; width: 90%; max-width: 900px; }
    label { display: block; margin-top: 10px; }
    input, select, button { padding: 8px; margin-top: 5px; width: 100%; border-radius: 4px; border: 1px solid #ccc; }
    button { background: #007bff; color: #fff; cursor: pointer; border: none; }
    button:hover { background: #0056b3; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 8px; text-align: center; }
  </style>
</head>
<body>

  <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ù†ØµØ© Ù†ÙˆÙ†</h1>

  <!-- Ø¥Ø¶Ø§ÙØ© Ø£Ø³ØªØ§Ø° -->
  <div class="section">
    <h2>Ø¥Ø¶Ø§ÙØ© Ø£Ø³ØªØ§Ø°</h2>
    <label>Ø§Ø³Ù… Ø§Ù„Ø£Ø³ØªØ§Ø°:</label>
    <input type="text" id="teacherName">
    <label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:</label>
    <input type="email" id="teacherEmail">
    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
    <input type="password" id="teacherPassword">
    <button onclick="addTeacher()">Ø¥Ø¶Ø§ÙØ©</button>
  </div>

  <!-- Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø² ÙŠØ¯ÙˆÙŠ -->
  <div class="section">
    <h2>Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø² ÙŠØ¯ÙˆÙŠ</h2>
    <label>Ø§Ù„Ø£Ø³ØªØ§Ø°:</label>
    <select id="teacherSelect"></select>
    <label>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
    <input type="text" id="studentName">
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²:</label>
    <input type="date" id="bookingDate">
    <button onclick="createManualBooking()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¬Ø²</button>
  </div>

  <!-- Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ÙŠÙˆÙ… -->
  <div class="section">
    <h2>Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ÙŠÙˆÙ…</h2>
    <button onclick="printToday()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ÙŠÙˆÙ…</button>
    <table id="todayBookings">
      <thead>
        <tr><th>Ø§Ù„Ø£Ø³ØªØ§Ø°</th><th>Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ØºØ¯ -->
  <div class="section">
    <h2>Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ØºØ¯</h2>
    <button onclick="printTomorrow()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ØºØ¯</button>
    <table id="tomorrowBookings">
      <thead>
        <tr><th>Ø§Ù„Ø£Ø³ØªØ§Ø°</th><th>Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ø´Ù‡Ø± -->
  <div class="section">
    <h2>Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ø´Ù‡Ø±</h2>
    <table id="monthlyBookings">
      <thead>
        <tr><th>Ø§Ù„Ø£Ø³ØªØ§Ø°</th><th>Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyASqGIwNVzkLt2t6pIRRrd7WC2ltN4A34E",
      authDomain: "noon-4dec9.firebaseapp.com",
      projectId: "noon-4dec9",
      storageBucket: "noon-4dec9.appspot.com",
      messagingSenderId: "419619843903",
      appId: "1:419619843903:web:abc123"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ğŸ§‘â€ğŸ« Ø¥Ø¶Ø§ÙØ© Ø£Ø³ØªØ§Ø°
    async function addTeacher() {
      const name = document.getElementById("teacherName").value;
      const email = document.getElementById("teacherEmail").value;
      const password = document.getElementById("teacherPassword").value;
      if (!name || !email || !password) { alert("Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„"); return; }

      try {
        await db.collection("teachers").add({ name, email, password });
        alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù†Ø¬Ø§Ø­ âœ…");
        loadTeachers();
      } catch (err) {
        console.error("Ø®Ø·Ø£ Ø¥Ø¶Ø§ÙØ© Ø£Ø³ØªØ§Ø°:", err);
      }
    }

    // ğŸ“‹ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©
    async function loadTeachers() {
      const select = document.getElementById("teacherSelect");
      select.innerHTML = "";
      try {
        const snapshot = await db.collection("teachers").get();
        snapshot.forEach(doc => {
          const option = document.createElement("option");
          option.value = doc.id;
          option.textContent = doc.data().name;
          select.appendChild(option);
        });
      } catch (err) {
        console.error("Ø®Ø·Ø£ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø©:", err);
      }
    }

    // âœï¸ Ø¥Ø¶Ø§ÙØ© Ø­Ø¬Ø² ÙŠØ¯ÙˆÙŠ
    async function createManualBooking() {
      const teacherId = document.getElementById("teacherSelect").value;
      const studentName = document.getElementById("studentName").value;
      const bookingDate = document.getElementById("bookingDate").value;

      if (!teacherId || !studentName || !bookingDate) { alert("Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„"); return; }

      try {
        await db.collection("bookings").add({
          teacherId, studentName,
          date: bookingDate
        });
        alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¬Ø² âœ…");
        loadBookings();
      } catch (err) {
        console.error("Ø®Ø·Ø£ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ø§Ù„ÙŠØ¯ÙˆÙŠ:", err);
      }
    }

    // ğŸ“… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
    async function loadBookings() {
      const today = new Date().toISOString().split("T")[0];
      const tomorrow = new Date(Date.now() + 86400000).toISOString().split("T")[0];
      const month = today.substring(0,7);

      const todayTable = document.querySelector("#todayBookings tbody");
      const tomorrowTable = document.querySelector("#tomorrowBookings tbody");
      const monthlyTable = document.querySelector("#monthlyBookings tbody");
      todayTable.innerHTML = ""; tomorrowTable.innerHTML = ""; monthlyTable.innerHTML = "";

      try {
        const snapshot = await db.collection("bookings").get();
        snapshot.forEach(doc => {
          const data = doc.data();
          const row = `<tr><td>${data.teacherId}</td><td>${data.studentName}</td><td>${data.date}</td></tr>`;
          if (data.date === today) todayTable.innerHTML += row;
          if (data.date === tomorrow) tomorrowTable.innerHTML += row;
          if (data.date.startsWith(month)) monthlyTable.innerHTML += row;
        });
      } catch (err) {
        console.error("Ø®Ø·Ø£ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª:", err);
      }
    }

    // ğŸ–¨ï¸ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
    function printToday() { window.print(); }
    function printTomorrow() { window.print(); }

    // ØªØ­Ù…ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­
    loadTeachers();
    loadBookings();
  </script>
</body>
</html>
